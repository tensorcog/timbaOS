
Running 2 tests using 2 workers

[1A[2K[1/2] [chromium] â€º tests/e2e/pos.spec.ts:65:9 â€º POS Validation â€º Multiple Payment Methods (Split)
[1A[2K[2/2] [chromium] â€º tests/e2e/order.spec.ts:46:9 â€º Order Validation â€º Order Status Transitions (Confirm)
[1A[2K[chromium] â€º tests/e2e/pos.spec.ts:65:9 â€º POS Validation â€º Multiple Payment Methods (Split)
Checkout Data: {
  "customerId": "a706cb22-e099-4886-abb9-16bb17d8a81f",
  "locationId": "f4d0250d-1099-4b65-b56c-0861c66f01c8",
  "items": [
    {
      "productId": "prod-1764340778832",
      "quantity": 2,
      "price": 100,
      "discount": 0
    }
  ],
  "payments": [
    {
      "method": "CASH",
      "amount": 100
    },
    {
      "method": "CREDIT_CARD",
      "amount": 100
    }
  ]
}

[1A[2KPayments found for order ac7d4e49-932c-4f76-8b5b-32d6d93104d8: 2

[1A[2K  1) [chromium] â€º tests/e2e/pos.spec.ts:65:9 â€º POS Validation â€º Multiple Payment Methods (Split) â”€â”€â”€

    PrismaClientKnownRequestError: 
    Invalid `prisma.product.delete()` invocation in
    /home/monty/spruce-killer/tests/e2e/pos.spec.ts:131:36

      128 expect(payments).toBe(2);
      129 
      130 // Cleanup
    â†’ 131 await prisma.product.delete(
    Foreign key constraint violated: `OrderItem_productId_fkey (index)`

      129 |
      130 |         // Cleanup
    > 131 |         await prisma.product.delete({ where: { id: product.id } });
          |                                    ^
      132 |     });
      133 |
      134 |     test('POS Tax Calculation', async () => {
        at /home/monty/spruce-killer/tests/e2e/pos.spec.ts:131:36
        at $n.handleRequestError (/home/monty/spruce-killer/node_modules/@prisma/client/runtime/library.js:121:7315)
        at $n.handleAndLogRequestError (/home/monty/spruce-killer/node_modules/@prisma/client/runtime/library.js:121:6623)
        at $n.request (/home/monty/spruce-killer/node_modules/@prisma/client/runtime/library.js:121:6307)
        at l (/home/monty/spruce-killer/node_modules/@prisma/client/runtime/library.js:130:9633)
        at /home/monty/spruce-killer/tests/e2e/pos.spec.ts:131:9


[1A[2K  1 failed
    [chromium] â€º tests/e2e/pos.spec.ts:65:9 â€º POS Validation â€º Multiple Payment Methods (Split) â”€â”€â”€â”€
  1 passed (730ms)

[36m  Serving HTML report at http://localhost:50415. Press Ctrl+C to quit.[39m
